# nto2024
## CTF
### Web1

Нашли хинт про секрет, etc означает корневую папку, значит, надо искать где-то выше.

Ссылка: `http://192.168.12.10:5001/download?file_type=../../../../etc/secret`

### Web2

1) Декомпилировали .jar файл при помощи jd-gui утилиты linux

2) Поняли, что используется фреймворк Spring

3) Погуглили его уязвимости, нашли на [сайте](https://www.veracode.com/blog/secure-development/spring-view-manipulation-vulnerability) точно такой же обработчик, как в задании и поняли, что идем в правильном направлении (уязвимость spring view)

4) На этом же сайте был приложен эксплоит уязвимости, мы поменяли в нем `"touch execution"` на `"cat flag"`, потому что что делает первое мы не знаем, а второе выводит флаг

Ссылка: `http://192.168.12.13:809](http://192.168.12.13:8090/)0/doc/__${T(java.lang.Runtime).getRuntime().exec("cat flag")}__::..x`

### Web3

1) По конфигу прокси поняли, что haproxy запрещает доступ ко всем запросам, которые начинаются с `/flag`, попытались это обойти при помощи уязвимости Haproxy с переполнением Content-Length (request smuggling), но в итоге просто ввели `http://192.168.12.11:8001/](http://192.168.12.11:8001/)/flag` и получили доступ

2) В параметре name передают что-то, приложение банит какие-то особенные символы, в следсвтие чего мы подумали, что надо туда ввести что-нибудь, что выкинет нам содержимое flag.txt (не зря же он лежит в папке с приложением)

3) Поняли, что в коде имя на страницу вставляется при помощи движка у flask, то есть благодаря Jinja2, [погуглили уязвимости](https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti) и нашли эксплоит без запрещенных слов

Ссылка:  `http://192.168.12.11:8001//flag?name={{ get_flashed_messages.__globals__.__builtins__.open("flag.txt").read() }](http://192.168.12.11:8001//flag?name=%7B%7B%20get_flashed_messages.__globals__.__builtins__.open(%22flag.txt%22).read()%20%7D)}`

### Crypto1

1) Предположили, что пинкод состоит из 4-ех цифр

2) Написали скриптик, перебирающий возможный пинкод `(crypto1.py)`

- наш пинкод шифрует
- получает текущий шифр пинкода задания
- сравнивает

3) Нашли пинкод - 3561 и получили флаг через checkPin

## Windows

### task1

По легенде все понятно: ему пришла фишинговая рассылка, он скачал из письма файл.

### task2

Адрес: 95.169.192.220:8080

Зашли в просмотр событий Windows, поняли, что все пошло-поехало 3 марта в 18:43. В это же время в power shell начали выполняться инструкции на скачивание prikol.exe с сервера с таким адресом.

### task3

WinRAR CVE-2023-38831

Там был безобидный файл, но, когда юзер его открыл, запустился .bat файл с инструкциями на скачивание prikol.exe в файл rjomba.exe.

### task4

1) Скачали prikol.exe с сервера

2) Залили его в песочницу virustotal (анализатор) и получили вот:

- `KernelBase.dll! IsDebuggerPresent #highlighted (#2340)
Arguments: {“desc”:”Checks if the application is being debugged.”}` -> проверка наличия отладчика
- `EnumProcesses` -> Вредоносное ПО может использовать его для запроса
 списка запущенных процессов для обнаружения работы инструментов 
анализа.

### task5

1) На virustotal в разделе Capabilities - data-manipulation: `encrypt data using AES via x86 extensions`

2) Залили файл в гидру и там нашли, что в пространстве имен есть CBC - метод шифрования

3) На виртуальной машине тоже скачали prikol.exe. Там еще сделалинаш файл `o.txt` с текстом `a`, чтобы потом его добило до длины ключа. Затем запустили prikol.exe и посмотрели, какая длина у зашифрованного текста - это размер ключа

### task6

1) Длина ключа 256 бит, значит, длина ключа в символах $256 / 8 = 32$

2) Скачали ProcessHacker, переименовали его в 123 (чтобы prikol.exe не закрывался сразу), запустили prikol.exe и сделали дамп памяти.

3) При помощи утилиты strings нашли в дампе памяти строки длины 32 и сам ключ, отличающийся от всех остальных строк длины 32 интересующим содержанием

### task8

> sFYZ#2z9VdUR9sm`3JRz

1) Нам еще нужен был вектор инициализации. Он в дампе памяти стоял рядом с ключом. IV: `ababab`

2) В онлайн дешифраторе AES-256 CBC дешифровали содержимое нужного файла
